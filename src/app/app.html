<div class="container">
  <h1>{{ title }}</h1>

  <div *ngIf="!gameStarted" class="hp-selection">
    <h2>Starting HP: </h2>
    <select [(ngModel)]="selectedHp">
      <option *ngFor="let hp of possibleHpValues" [value]="hp">{{ hp }}</option>
    </select>
    <button (click)="startGame()">Start Game</button>
  </div>

  <div *ngIf="gameStarted">
    <div class="players-status">
      <!-- Player 1 -->
      <div class="player player-left">
        <p>{{ selectedPlayer1.name }}</p>
        <div class="player-container">
          <img [src]="selectedPlayer1.image" alt="{{ selectedPlayer1.name }}" />
          <div class="hp-bar-overlay">
            <div class="hp-fill player1" [style.width.%]="getHpPercentage('player1')" [style.backgroundColor]="getHpColor('player1')"></div>
            <div class="hp-text">{{ player1Hp }} / {{ selectedHp }}</div>
            <ng-container *ngFor="let f of floatingDamages">
              <span *ngIf="f.player==='player1'" class="floating-damage">-{{ f.amount }}</span>
            </ng-container>
          </div>
        </div>
      </div>

      <!-- Player 2 -->
      <div class="player player-right">
        <p>{{ selectedPlayer2.name }}</p>
        <div class="player-container">
          <img [src]="selectedPlayer2.image" alt="{{ selectedPlayer2.name }}" />
          <div class="hp-bar-overlay">
            <div class="hp-fill player2" [style.width.%]="getHpPercentage('player2')" [style.backgroundColor]="getHpColor('player2')"></div>
            <div class="hp-text">{{ player2Hp }} / {{ selectedHp }}</div>
            <ng-container *ngFor="let f of floatingDamages">
              <span *ngIf="f.player==='player2'" class="floating-damage">-{{ f.amount }}</span>
            </ng-container>
          </div>
        </div>
      </div>
    </div>

    <!-- Round input -->
    <div *ngIf="!isGameOver()" class="round-form">
      <h2>Round Input</h2>
      <div class="round-inputs">
        <div class="player-number">
          <label>{{ selectedPlayer1.name }}</label>
          <input type="number" [(ngModel)]="player1Number" />
        </div>

        <div class="round-winner">
          <label>Winner</label>
          <select [(ngModel)]="roundWinner">
            <option [value]="'player1'">{{ selectedPlayer1.name }}</option>
            <option [value]="'player2'">{{ selectedPlayer2.name }}</option>
          </select>
        </div>

        <div class="player-number">
          <label>{{ selectedPlayer2.name }}</label>
          <input type="number" [(ngModel)]="player2Number" />
        </div>
      </div>
      <button (click)="playRound()">Play Round</button>
    </div>

    <div class="result">
      <p>{{ roundResultMessage }}</p>
    </div>

    <div class="history">
      <h3>Round History</h3>
      <ul>
        <li *ngFor="let r of rounds" class="history-item">
          Round {{ r.round }}: {{ selectedPlayer1.name }}={{ r.player1Number }},
          {{ selectedPlayer2.name }}={{ r.player2Number }}, Winner={{ r.winner }},
          Damage={{ r.damage }}
        </li>
      </ul>
    </div>

    <div *ngIf="isGameOver()" class="game-over">
      <h2>Game Over</h2>
      <p>{{ getWinner() }}</p>
      <button (click)="gameStarted = false">Restart Game</button>
    </div>
  </div>
</div>
